## HotDeal

### 

<br/>
1000만건 이상의 상품데이터를 빠르고 정확하게 검색가능한 이커머스 서비스 핫딜🔥!<br>
내가 원하는 상품 빠르게 검색 가능한 조건 검색 서비스🔎<br>
전날 기준 판매 수량이 가장 많은 인기 상품 조회 서비스🔎<br>
대량의 트래픽 속에도 안정적인 동시성 제어를 통한 구매 서비스🛒
<br/>

### 📆 프로젝트 기간

- 2023.05.19 ~ 2023.06.??

<br/>

###  🐾 Project Members 

<table>
   <tr>
    <td align="center"><b><a href="https://github.com/InyongHwang">💀 황인용</a></b></td>
    <td align="center"><b><a href="https://github.com/seonminKim1122">👨‍⚕️ 김선민</a></b></td>
    <td align="center"><b><a href="https://github.com/Joyanggi">🦇 조양기</a></b></td>
    <td align="center"><b><a href="https://github.com/SeokBin02">🃏 황석빈</a></b></td>
  </tr>
  <tr>
    <td align="center"><a href="https://github.com/InyongHwang"><img src="https://avatars.githubusercontent.com/u/123296558?v=4" width="100px" /></a></td>
    <td align="center"><a href="https://github.com/seonminKim1122"><img src="https://avatars.githubusercontent.com/u/124031561?v=4" width="100px" /></a></td>
    <td align="center"><a href="https://github.com/Joyanggi"><img src="https://avatars.githubusercontent.com/u/95532786?s=96&v=4" width="100px" /></a></td>
    <td align="center"><a href="https://github.com/SeokBin02"><img src="https://avatars.githubusercontent.com/u/121082974?v=4" width="100px" /></a></td>
  </tr>
  <tr>
    <td align="center"><b>🌱 Spring</b></td>
    <td align="center"><b>🌱 Spring</b></td>
    <td align="center"><b>🌱 Spring</b></td>
    <td align="center"><b>🌱 Spring</b></td>
  </tr>
</table>

<br/>
<br/>

## Service Architecture

![Architecture](https://github.com/InyongHwang/HotDeal/assets/95532786/0952d469-846d-419a-bbc1-fbc87008a416)

<br/>

## 주요 기능 소개 

| 조건 검색 기능 | 조건 검색 기능 |
|:-------:|:-------------------------------------------------------------------------------------------------------------:|
| ![대,중분류별검색기능](https://github.com/InyongHwang/HotDeal/assets/95532786/e6792240-6799-4990-bb8f-906ab437d6fc) | ![최소,최대가격조건검색기능](https://github.com/InyongHwang/HotDeal/assets/95532786/3d1a8ab6-2cf5-4b2b-af50-558166d98a6a) |
| - 대, 중분류 별 검색 기능 | - 최소, 최대 가격 조건 검색 기능 |

| 조건 검색 기능 | 조건 검색 기능 |
|:----------------------------------------------------------------------------------------------------------------:|:--------------------------------:|
| ![키워드검색기능](https://github.com/InyongHwang/HotDeal/assets/95532786/8dc30315-b0df-4b46-b7ae-ee50b45b7865) | ![인기상품조회기능](https://github.com/InyongHwang/HotDeal/assets/95532786/10e7349e-e9e3-46f2-8c82-efa789eba822)|
| - 키워드 검색 기능 | - 인기 상품 조회 기능 |

| 회원 가입 기능 | 로그인 기능 |
|:----------------------------------------------------------------------------------------------------------------:|:--------------------------------:|
| ![회원가입](https://github.com/InyongHwang/HotDeal/assets/95532786/1636a051-c295-4f5a-a84d-f192544ef7bd) | ![로그인](https://github.com/InyongHwang/HotDeal/assets/95532786/de79647d-ae21-4dd6-a4f0-8195b5a8cac3)|
| - 회원 가입 기능 | - 로그인 기능 |

| 구매 기능 |
|:-----------------------------------------------------------------------------------------------------------------:|
| ![구매기능](https://github.com/InyongHwang/HotDeal/assets/95532786/0d8c3d34-4b7b-4dc5-9b74-87250f02b82c) |
| - 구매 기능 |

<br/>
<br/>

## ☁️ ERD 
<details>
<summary> 펼쳐보기 </summary>
<div markdown="1">  

![ERD](https://github.com/InyongHwang/HotDeal/assets/95532786/ac778bb7-2ac1-44b0-a870-90713b64a549)

</div>
</details>

<br>
<br>

## 성능개선

- 조건 검색 성능 개선  
  👉 <a href="https://hot-deal.notion.site/70149f6f68664dfb9a22b8d44af6c790?pvs=4" target="_blank"> 조건 검색 성능 개선 기록 보기 </a>
  <br>
  👉 <a href="https://hot-deal.notion.site/7f4804e057a74118ad6413d0c2c0791e?pvs=4" target="_blank"> 조건 검색 성능 테스트 보기 </a>

- 인기 상품 조회 성능 개선  
  👉 <a href="https://hot-deal.notion.site/a1a841de8b3b4269a6210c487e502927?pvs=4" target="_blank"> 인기 상품 조회 성능 개선 기록 보기 </a>
  <br>
  👉 <a href="https://hot-deal.notion.site/5c505c74641340b39089100b03e74cbe?pvs=4" target="_blank"> 인기 상품 조회 성능 테스트 보기 </a>

- 동시성 제어 테스트  
  👉 <a href="https://hot-deal.notion.site/fab52cf946cb44d183cb4372c3cae04e?pvs=4" target="_blank"> 동시성제어 테스트 보기 </a>
  
- 데이터 수집, 생성 및 관리  
  👉 <a href="https://hot-deal.notion.site/abedb9e482744224b3006c4c95c5ecda?pvs=4" target="_blank"> 데이터 수집, 생성 및 관리 기록 보기 </a>

## Trouble Shooting

#### 🚨 Issue 1
### 데이터 수집 및 생성 

A. 크롤링을 통해 데이터를 수집하는 과정에서 크롤링이 일부 진행된 이후 기하급수적으로 빠른 속도로 처리가 되고 프로세스가 종료되는 현상 발생<br>

🛑 cause : <br>
- 존재하지 않는 페이지에 대해서 빠르게 반복적인 요청을 보냄에 따라 IP가 일시적으로 차단 당했다고 판단하였습니다.

#### 🚥 solution :
- 크롤링 결과 빈 값을 반환하는 페이지를 마주칠 경우 더 이상 해당 카테고리에 대한 크롤링을 멈추고 다음 카테고리로 넘어가는 코드로 수정하였습니다.
- 페이지 이동 간 휴식 시간 부여하였습니다.
<br>

B. 구매 데이터 확보를 위해 매일 새벽 1만 번의 구매 작업을 진행하는 상황에서 아침에 매번 서버가 다운되어 제대로 동작하지 않는 현상 발생<br>
 
#### 🚥 solution : 
- 구매 데이터 생성 작업이 서버에 한 번에 일으키는 부하를 줄임으로써 서버가 다운되는 문제를 해결하였습니다.
<hr/>

#### 🚨 Issue 2
### 테스트 코드 작성  

상품 구매에 대한 테스트 코드를 작성했으나 실제 재고가 감소하지 않는 문제 발생

🛑 cause: <br>
- update 쿼리가 존재하지 않음. 현재 구매 로직에서는 JPA 더티 체킹을 통해 자동으로 update 를 하고 있는데 테스트 코드에서는 더티 체킹이 동작하지 않았다고 판단하였습니다.
- 테스트 코드 상에서 LimitedProductService 인스턴스를 직접 만들어서 사용하고 있기 때문에 빈 객체가 아니어서 발생한 문제였습니다.

#### 🚥 solution :
- 테스트 코드에서 LimitedProductService도 @Autowired 를 이용해 주입 받는 것으로 변경해서 해결하였습니다.

<hr/>

#### 🚨 Issue 3
### Docker hub 로그인 시 Unauthorized Error   

콘솔에서 docker hub 로그인시 unauthorized Error

🛑 cause: <br>
- docker hub 비밀번호가 ! 로 시작되어 콘솔에서 이벤트로 인식하여 발생한 문제였습니다. 

#### 🚥 solution :
- docker hub 로그인 비밀번호를 수정하였습니다. (!password → password, 맨 앞 느낌표 제거)
- <a href="https://2nyongs.tistory.com/108" target="_blank"> 블로그 정리 글 </a>

## 🛠 Tools

#### Backend

<p>
  <img src="https://img.shields.io/badge/Java-007396?style=for-the-badge&logo=Java&logoColor=white"/>
  <img src="https://img.shields.io/badge/SpringBoot-6DB33F?style=for-the-badge&logo=SpringBoot&logoColor=white">
  <img src="https://img.shields.io/badge/SpringSecurity-6DB33F?style=for-the-badge&logo=SpringSecurity&logoColor=white">
  <img src="https://img.shields.io/badge/SpringBatch-6DB33F?style=for-the-badge&logo=SpringBatch&logoColor=white">
  <img src="https://img.shields.io/badge/Python-3776AB?style=for-the-badge&logo=Python&logoColor=white">
  <img src="https://img.shields.io/badge/gradle-02303A?style=for-the-badge&logo=gradle&logoColor=white">
  <img src="https://img.shields.io/badge/QueryDSL-5A29E4?style=for-the-badge&logo=QueryDSL&logoColor=white">
  <br>
  <img src="https://img.shields.io/badge/MySQL-4479A1?style=for-the-badge&logo=MySQL&logoColor=white">
  <img src="https://img.shields.io/badge/Redis-DC382D?style=for-the-badge&logo=Redis&logoColor=white">
  <img src="https://img.shields.io/badge/AmazonRDS-527FFF?style=for-the-badge&logo=AmazonRDS&logoColor=white">
</p>

#### Frontend

<p>
  <img src="https://img.shields.io/badge/HTML5-E34F26?style=for-the-badge&logo=HTML5&logoColor=white"/>
  <img src="https://img.shields.io/badge/CSS3-1572B6?style=for-the-badge&logo=CSS3&logoColor=white"/>
  <img src="https://img.shields.io/badge/JavaScript-F7DF1E?style=for-the-badge&logo=JavaScript&logoColor=white"/>
  <img src="https://img.shields.io/badge/Axios-5A29E4?style=for-the-badge&logo=Axios&logoColor=white"/>
</p>

#### Platform

<p>
  <img src="https://img.shields.io/badge/Ubuntu-E95420?style=for-the-badge&logo=Ubuntu&logoColor=white"/>
</p>

#### DevOps

<p>
  <img src="https://img.shields.io/badge/AmazonEC2-FF9900?style=for-the-badge&logo=AmazonEC2&logoColor=white" > 
  <img src="https://img.shields.io/badge/Docker-2496ED?style=for-the-badge&logo=Docker&logoColor=white">
</p>

#### CI/CD

<p>
  <img src="https://img.shields.io/badge/GitHubActions-2088FF?style=for-the-badge&logo=GitHubActions&logoColor=white" > 
</p>

#### Test

<p>
  <img src="https://img.shields.io/badge/JUnit5-25A162?style=for-the-badge&logo=JUnit5&logoColor=white" > 
  <img src="https://img.shields.io/badge/ApacheJMeter-D22128?style=for-the-badge&logo=ApacheJMeter&logoColor=white" >
</p>

#### Dev tools

<p> 
  <img src="https://img.shields.io/badge/git-%23F05033.svg?style=for-the-badge&logo=git&logoColor=white">
  <img src="https://img.shields.io/badge/github-%23121011.svg?style=for-the-badge&logo=github&logoColor=white">
</p>

<br>
<br>
